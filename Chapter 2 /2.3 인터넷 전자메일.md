# 2.3 μΈν„°λ„· μ „μλ©”μΌ
μΌλ° μ°νΈκ³Ό λ§μ°¬κ°€μ§€λ΅ μ „μλ©”μΌμ€ λΉ„λ™κΈ°μ μΈ ν†µμ‹  λ§¤μ²΄λ‹¤.<br/>
μΌλ° μ°νΈκ³Ό λ‹¤λ¥΄κ² μ „μλ©”μΌμ€ λ¶„λ°°κ°€ μ‰½κ³ , λΉ λ¥΄κ³ , μ €λ ΄ν•λ‹¤.<br/>

## μΈν„°λ„· λ©”μΌ μ‹μ¤ν…μ μƒμ„ λ λ²¨ κ°λ…
- 3κ°€μ§€ μ£Όμ” μ”μ†
  - **μ‚¬μ©μ μ—μ΄μ „νΈ(user agent)**
    - λ€ν‘μ μΈ μλ΅, λ§μ΄ν¬λ΅μ†ν”„νΈ μ•„μ›ƒλ£©(outlook), μ• ν” λ©”μΌ, μ§€λ©”μΌ(Gmail) λ“± μ΅΄μ¬
  - **λ©”μΌ μ„λ²„(mail server)**
    - μ „μλ©”μΌ μΈν”„λΌμ¤νΈλ­μ²μ μ¤‘μ‹¬
    - `λ©”μΌλ°•μ¤(mailbox)`λ¥Ό κ°–κ³  μλ‹¤.
  - **SMTP(Simple Mail Transfer Protocol)**
    - μΈν„°λ„· μ „μλ©”μΌμ„ μ„ν• μ£Όμ” μ• ν”λ¦¬μΌ€μ΄μ… κ³„μΈµ ν”„λ΅ν† μ½
    - λ©”μΌ μ „μ†΅ν•λ” λ° TCPμ μ‹ λΆ°μ μΈ λ°μ΄ν„° μ „μ†΅ μ„λΉ„μ¤λ¥Ό μ΄μ©
<br/>

<p align="center"><img width="400" src="https://github.com/user-attachments/assets/e07952f6-dd16-4110-b910-282fffccf6a8">

<br/>
<br/>

## 2.3.1 SMTP
`SMTP`λ” μ†΅μ‹ μμ λ©”μΌ μ„λ²„λ΅λ¶€ν„° μμ‹ μμ λ©”μΌ μ„λ²„λ΅ λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•λ‹¤.<br/>
> SMTPλ” HTTPλ³΄λ‹¤ ν›¨μ”¬ μ¤λλμ—λ‹¤, μ¦‰ μ—¬λ¬ μ¥μ μ΄ μμ§€λ§ λ‚΅μ€ νΉμ„±μ„ κ°€μ§„ μ¤λλ κΈ°μ 
<br/>

μλ¥Ό λ“¤μ–΄, SMTPλ” λ¨λ“  λ©”μΌ λ©”μ‹μ§€μ λΈμ²΄λ” λ‹¨μν• 7λΉ„νΈ ASCIIμ—¬μ•Ό ν•λ‹¤λ” λ‹¨μ <br/>
-> κ³Όκ±°μ—λ” λ€μ©λ‰ μ²¨λ¶€νμΌμ„ λ³΄λ‚΄μ§€ μ•μ•„ μλ―Έκ°€ μμ—μΌλ‚ ν„λ€μ—λ” μ΄ μ ν•μ΄ λ¬Έμ λ¥Ό μΌμΌν‚¨λ‹¤.<br/>
<br/>

### **SMTP κΈ°λ³Έ λ™μ‘ κ³Όμ • μ‹λ‚λ¦¬μ¤**<br/>
μ•¨λ¦¬μ¤κ°€ κ°„λ‹¨ν• ASCII λ©”μ‹μ§€λ¥Ό λ°¥μ—κ² λ³΄λ‚΄λ” μ‹λ‚λ¦¬μ¤<br/>

1. μ•¨λ¦¬μ¤λ” μ „μ λ©”μΌ μ‚¬μ©μ μ—μ΄μ „νΈλ¥Ό μν–‰ν•κ³ , λ°¥μ μ „μ λ©”μΌ μ£Όμ†λ¥Ό μ κ³µν•μ—¬ λ©”μ‹μ§€λ¥Ό λ³΄λ‚΄λΌκ³  λ…λ Ήν•λ‹¤.<br/>

2. μ•¨λ¦¬μ¤μ μ‚¬μ©μ μ—μ΄μ „νΈλ” λ©”μ‹μ§€λ¥Ό κ·Έλ…€μ λ©”μΌ μ„λ²„μ—κ² λ³΄λ‚΄κ³ , κ·Έκ³³μ—μ„ λ©”μ‹μ§€λ” λ©”μ‹μ§€ νμ— λ†“μΈλ‹¤.<br/>

3. μ•¨λ¦¬μ¤μ λ©”μΌ μ„λ²„μ—μ„ λ™μ‘ν•λ” SMTPμ ν΄λΌμ΄μ–ΈνΈ μΈ΅μ€ λ©”μ‹μ§€ νμ— μλ” λ©”μ‹μ§€λ¥Ό λ³Έλ‹¤.<br/>
   λ°¥μ λ©”μΌ μ„λ²„μ—μ„ μν–‰λκ³  μλ” SMTP μ„λ²„μ—κ² TCP μ—°κ²°μ„ μ„¤μ •ν•λ‹¤.<br/>
   
4. μ΄κΈ° SMTP ν•Έλ“μ…°μ΄ν‚Ή μ΄ν›„μ— SMTP ν΄λΌμ΄μ–ΈνΈλ” μ•¨λ¦¬μ¤μ λ©”μ‹μ§€λ¥Ό TCP μ—°κ²°λ΅ λ³΄λ‚Έλ‹¤.<br/>

5. λ°¥μ λ©”μΌ μ„λ²„ νΈμ¤νΈμ—μ„ SMTPμ μ„λ²„ μΈ΅μ€ λ©”μ‹μ§€λ¥Ό μμ‹ ν•λ‹¤. λ°¥μ λ©”μΌ μ„λ²„λ” κ·Έ λ©”μ‹μ§€λ¥Ό λ°¥μ λ©”μΌ λ°•μ¤μ— λ†“λ”λ‹¤.<br/>

6. λ°¥μ€ νΈν• μ‹κ°„μ— κ·Έ λ©”μ‹μ§€λ¥Ό μ½κΈ° μ„ν•΄ μ‚¬μ©μ μ—μ΄μ „νΈλ¥Ό μ‹λ™ν•λ‹¤.<br/>

<br/>

<p align="center"><img width="600" src="https://github.com/user-attachments/assets/b683f100-cbb9-451d-b949-d09dbb191a4b">

<br/>
<br/>

> π’΅SMTPλ” λ©”μΌμ„ λ³΄λ‚Ό λ• λ‘ λ©”μΌ μ„λ²„κ°€ λ¨Ό κ±°λ¦¬μ— λ–¨μ–΄μ Έ μλ”λΌλ„ μ¤‘κ°„ λ©”μΌ μ„λ²„λ¥Ό μ‚¬μ©ν•μ§€ μ•μ<br/>
<br/>

### **SMTPκ°€ λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•λ” κ³Όμ •**<br/>
SMTP ν”„λ΅ν† μ½μ€ λ§μ£Όλ³Έ(face-to-face) μ‚¬λμ μƒνΈμ‘μ©μ— μ΄μ©λλ” ν”„λ΅ν† μ½κ³Ό μ μ‚¬<br/>

1. ν΄λΌμ΄μ–ΈνΈ SMTPλ” μ„λ²„ SMTPμ **25λ² ν¬νΈλ΅ TCP μ—°κ²°μ„ μ„¤μ •**
   > λ§μ•½ μ„λ²„κ°€ μ£½μ–΄ μμΌλ©΄ ν΄λΌμ΄μ–ΈνΈλ” λ‚μ¤‘μ— λ‹¤μ‹ μ‹λ„
2. μ—°κ²°μ΄ μ„¤μ •λλ©΄ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ” μ• ν”λ¦¬μΌ€μ΄μ… κ³„μΈµ ν•Έλ“μ…°μ΄ν‚Ήμ„ μν–‰
   > μ΄ κ³Όμ • λ™μ•μ— SMTP ν΄λΌμ΄μ–ΈνΈλ” μ†΅/μμ‹ μμ μ „μλ©”μΌ μ£Όμ† μ κ³µ
3. ν΄λΌμ΄μ–ΈνΈκ°€ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Έλ‹¤.
   > μ΄ λ•, μ¤λ¥ μ—†μ΄ λ©”μ‹μ§€λ¥Ό μ „λ‹¬ν•κΈ° μ„ν•΄ TCP μ‹ λΆ°μ  λ°μ΄ν„° μ „μ†΅ μ„λΉ„μ¤μ— μμ΅΄
4. λ” μ΄μƒ λ³΄λ‚Ό λ©”μ‹μ§€κ°€ μ—†λ‹¤λ©΄ TCPμ— μ—°κ²° λ‹«μ„ κ²ƒμ„ λ…λ Ή
<br/>

### SMTP ν΄λΌμ΄μ–ΈνΈ(C)μ™€ SMTP μ„λ²„(S) μ‚¬μ΄μ λ©”μ‹μ§€ μ „λ‹¬ κ³Όμ • μ
> SMTPλ” μ§€μ†(persistent) μ—°κ²°μ„ μ‚¬μ©ν•λ‹¤
- ν΄λΌμ΄μ–ΈνΈ νΈμ¤νΈ μ΄λ¦„: crepes.fr
- μ„λ²„μ νΈμ¤νΈ μ΄λ¦„: hamburger.edu
- C: λ‹¤μμ— λ‚μ¤λ” ASCII ν…μ¤νΈ λΌμΈμ€ **ν΄λΌμ΄μ–ΈνΈκ°€** TCP μ†μΌ“μΌλ΅ λ³΄λ‚΄λ” λΌμΈ
- S: λ‹¤μμ— λ‚μ¤λ” ASCII ν…μ¤νΈ λΌμΈμ€ **μ„λ²„κ°€** TCP μ†μΌ“μΌλ΅ λ³΄λ‚΄λ” λΌμΈ
<br/>

```
S:  220 hamburger.edu
C:  HELO crepes.fr
S:  250 Hello crepes.fr, pleased to meet you
C:  π’΅MAIL FROM: <alice@crepes.fr>
S:  250 alice@crepes.fr ... Sender ok
C:  π’΅RCPT TO: <bob@hamburger.edu>
S:  250 bob@hamburger.edu ... Recipient ok
C:  π’΅DATA
S:  354 Enter mail, end with β€.β€ on a line by itself
C:  Do you like ketchup?
C:  How about pickles?
C:  .
S:  250 Message accepted for delivery
C:  π’΅QUIT
S:  221 hamburger.edu closing connection
```
<br/>

## 2.3.2 λ©”μΌ λ©”μ‹μ§€ ν¬λ§·
### ν—¤λ” λΌμΈ
μ „μλ©”μΌμ„ λ³΄λ‚Ό λ• μ£Όλ³€ μ •λ³΄κ°€ ν¬ν•¨λ ν—¤λ”κ°€ λ©”μ‹μ§€ λΈμ²΄ μ•μ— μ¤κ² λλ‹¤.<br/>
> ν—¤λ” λΌμΈκ³Ό λ©”μ‹μ§€ λΈμ²΄λ” λΉ μ¤„(CRLF)λ΅ λ¶„λ¦¬<br/>

HTTPμ²λΌ κ° ν—¤λ” λΌμΈμ€ ν‚¤μ›λ“, μ½λ΅ , κ°’μ μμ„λ΅ κµ¬μ„±λκ³  μ½μ„ μ μλ” ν…μ¤νΈλ¥Ό ν¬ν•¨ν•λ‹¤.<br/>
> ν‚¤μ›λ“λ” λ°λ“μ‹ ν•„μ”ν• κ²ƒλ„ μκ³ , μ„ νƒμ‚¬ν•­λ„ μλ‹¤.<br/>

π’΅ν•„μ ν—¤λ”λ΅λ” `FROM:`, `TO:`κ°€ μλ‹¤.
<br/>

μΌλ° λ©”μ‹μ§€ ν—¤λ”λ” λ‹¤μκ³Ό κ°™λ‹¤.
```
From: alice@crepes.fr
To: bob@hamburger.edu
Subject: Searching for the meaning of life.

Message(ν—¤λ” λΌμΈκ³Ό λΉ μ¤„λ΅ λ¶„λ¦¬λ ν›„ λ©”μ‹μ§€ λΈμ²΄κ°€ λ‚νƒ€λ‚λ‹¤.)
```
<br/>

## 2.3.3 λ©”μΌ μ ‘μ† ν”„λ΅ν† μ½
